
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>utils &#8212; pywfe  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Examples" href="examples/index.html" />
    <link rel="prev" title="core" href="core.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="utils">
<h1>utils<a class="headerlink" href="#utils" title="Permalink to this heading">¶</a></h1>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#io-utils" id="id1">io_utils</a></p></li>
<li><p><a class="reference internal" href="#comsol-loader" id="id2">comsol_loader</a></p></li>
<li><p><a class="reference internal" href="#frequency-sweep" id="id3">frequency_sweep</a></p></li>
<li><p><a class="reference internal" href="#modal-assurance" id="id4">modal_assurance</a></p></li>
</ul>
</nav>
<span class="target" id="module-pywfe.utils.io_utils"></span><section id="io-utils">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">io_utils</a><a class="headerlink" href="#io-utils" title="Permalink to this heading">¶</a></h2>
<p>This module contains the functionality needed to save and load pywfe.Model objects</p>
<dl class="py function">
<dt class="sig sig-object py" id="pywfe.utils.io_utils.load">
<span class="sig-prename descclassname"><span class="pre">pywfe.utils.io_utils.</span></span><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'local'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pywfe.utils.io_utils.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a model from the path to its folder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>folder</strong><span class="classifier">Path or str</span></dt><dd><p>The model to load.</p>
</dd>
<dt><strong>source</strong><span class="classifier">str, optional</span></dt><dd><p>Where to load the model from. The default is ‘local’.
If ‘database’ is chosen, searches for model in the database folder
located in the package directory. If ‘local’ is chosen but not found,
searches database.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model</strong><span class="classifier">pywfe.Model</span></dt><dd><p>The pywfe Model object.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>FileNotFoundError</dt><dd><p>Could not find the model folder.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pywfe.utils.io_utils.save">
<span class="sig-prename descclassname"><span class="pre">pywfe.utils.io_utils.</span></span><span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'local'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pywfe.utils.io_utils.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the model. Only saves mesh information and description, not results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>folder</strong><span class="classifier">path or str</span></dt><dd><p>Folder to save the model to. Creates a folder or overwrites if exists.</p>
</dd>
<dt><strong>model</strong><span class="classifier">pywfe.Model</span></dt><dd><p>The model to save.</p>
</dd>
<dt><strong>source</strong><span class="classifier">str, optional</span></dt><dd><p>Where to save the model to.
If ‘local’ uses current working directory.
If ‘database’ saves in the database folder in the package directory.
The default is ‘local’.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pywfe.utils.io_utils.database">
<span class="sig-prename descclassname"><span class="pre">pywfe.utils.io_utils.</span></span><span class="sig-name descname"><span class="pre">database</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pywfe.utils.io_utils.database" title="Permalink to this definition">¶</a></dt>
<dd><p>Lists all models in the database</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<span class="target" id="module-pywfe.utils.comsol_loader"></span><section id="comsol-loader">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">comsol_loader</a><a class="headerlink" href="#comsol-loader" title="Permalink to this heading">¶</a></h2>
<p>This module contains the functionality needed to convert COMSOL data
extracted from MATLAB LiveLink into a pywfe.Model class.</p>
<p>To extract the relevant matrices from COMSOL, use the following code
after <cite>out = model;</cite></p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">MA</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">mphmatrix</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;sol1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;out&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="s">&#39;K&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;D&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;E&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;L&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Kc&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Ec&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Null&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Nullf&#39;</span><span class="p">});</span>
<span class="n">info</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">mphxmeshinfo</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="n">fid</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">fopen</span><span class="p">(</span><span class="s">&quot;mesh_info.json&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;w&#39;</span><span class="p">);</span>
<span class="n">encodedJSON</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">jsonencode</span><span class="p">(</span><span class="n">info</span><span class="p">);</span><span class="w"> </span>
<span class="nb">fprintf</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span><span class="w"> </span><span class="n">encodedJSON</span><span class="p">);</span><span class="w"> </span>
<span class="nb">fclose</span><span class="p">(</span><span class="s">&#39;all&#39;</span><span class="p">);</span><span class="w"> </span>

<span class="nb">writematrix</span><span class="p">(</span><span class="n">MA</span><span class="p">.</span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;K.txt&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Delimiter&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;tab&#39;</span><span class="p">);</span>
<span class="nb">writematrix</span><span class="p">(</span><span class="n">MA</span><span class="p">.</span><span class="n">E</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;M.txt&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Delimiter&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;tab&#39;</span><span class="p">);</span>

<span class="nb">writematrix</span><span class="p">(</span><span class="n">MA</span><span class="p">.</span><span class="n">Kc</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Kc.txt&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Delimiter&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;tab&#39;</span><span class="p">);</span>
<span class="nb">writematrix</span><span class="p">(</span><span class="n">MA</span><span class="p">.</span><span class="n">Ec</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Mc.txt&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Delimiter&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;tab&#39;</span><span class="p">);</span>

<span class="nb">writematrix</span><span class="p">(</span><span class="n">MA</span><span class="p">.</span><span class="n">Null</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Null.txt&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Delimiter&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;tab&#39;</span><span class="p">);</span>
<span class="nb">writematrix</span><span class="p">(</span><span class="n">MA</span><span class="p">.</span><span class="n">Nullf</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Nullf.txt&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Delimiter&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;tab&#39;</span><span class="p">);</span>
</pre></div>
</div>
<dl class="py function">
<dt class="sig sig-object py" id="pywfe.utils.comsol_loader.load_comsol">
<span class="sig-prename descclassname"><span class="pre">pywfe.utils.comsol_loader.</span></span><span class="sig-name descname"><span class="pre">load_comsol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logging_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'transfer_matrix'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pywfe.utils.comsol_loader.load_comsol" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>folder</strong><span class="classifier">string</span></dt><dd><p>path to the folder containing the COMSOL LiveLink data.</p>
</dd>
<dt><strong>axis</strong><span class="classifier">int, optional</span></dt><dd><p>Waveguide axis. The default is 0.</p>
</dd>
<dt><strong>logging_level</strong><span class="classifier">int, optional</span></dt><dd><p>Logging level. The default is 20 (info).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model</strong><span class="classifier">pywfe.model class</span></dt><dd><p>a pywfe model.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pywfe.utils.comsol_loader.comsol_i2j">
<span class="sig-prename descclassname"><span class="pre">pywfe.utils.comsol_loader.</span></span><span class="sig-name descname"><span class="pre">comsol_i2j</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skiprows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pywfe.utils.comsol_loader.comsol_i2j" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts complex ‘j’ imaginary unit from COMSOL to python ‘j’</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filename</strong><span class="classifier">string</span></dt><dd><p>filename to convert.</p>
</dd>
<dt><strong>skiprows</strong><span class="classifier">int, optional</span></dt><dd><p>see numpy loadtxt. The default is 1.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<span class="target" id="module-pywfe.utils.frequency_sweep"></span><section id="frequency-sweep">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">frequency_sweep</a><a class="headerlink" href="#frequency-sweep" title="Permalink to this heading">¶</a></h2>
<p>This module contains the  fucntion for calculating various quantities over
an array of frequencies for a pywfe.Model object.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pywfe.utils.frequency_sweep.frequency_sweep">
<span class="sig-prename descclassname"><span class="pre">pywfe.utils.frequency_sweep.</span></span><span class="sig-name descname"><span class="pre">frequency_sweep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantities</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dofs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pywfe.utils.frequency_sweep.frequency_sweep" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a sweep over frequency array, extracting specified quantities
at each step. Modal assurance criterion can be used to track modes through
frequency by modeshape similarity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>model</strong><span class="classifier">pywfe.Model</span></dt><dd><p>The model to perform the sweep with.</p>
</dd>
<dt><strong>f_arr</strong><span class="classifier">np.ndarray float</span></dt><dd><p>Frequency array.</p>
</dd>
<dt><strong>quantities</strong><span class="classifier">list of str</span></dt><dd><p>A list of strings specifying the quantities to be calculated.
These are:</p>
<ul class="simple">
<li><p><cite>phi_plus</cite>: the (positive going) eigenvectors.</p></li>
<li><p><cite>excited_amplitudes</cite>: see <cite>pywfe.Model.excited_amplitudes</cite>.</p></li>
<li><p><cite>propagated_amplitudes</cite>: see <cite>pywfe.Model.propagated_amplitudes</cite>.</p></li>
<li><p><cite>modal_displacements</cite>: see <cite>pywfe.Model.modal_displacements</cite>.</p></li>
<li><p><cite>wavenumbers</cite>: see <cite>pywfe.Model.wavenumbers</cite>.</p></li>
<li><p><cite>displacements</cite>: see <cite>pywfe.Model.displacements</cite>.</p></li>
<li><p><cite>forces</cite>: see <cite>pywfe.Model.forces</cite>.</p></li>
</ul>
</dd>
<dt><strong>x_r</strong><span class="classifier">float, np.ndarray, optional</span></dt><dd><p>Response distance(s). The default is 0.</p>
</dd>
<dt><strong>mac</strong><span class="classifier">bool, optional</span></dt><dd><p>Use the modal assurance criterion to sort waves. The default is False.</p>
</dd>
<dt><strong>dofs</strong><span class="classifier">dofs, optional</span></dt><dd><p>The selected degrees of freedom. See <cite>pywfe.Model.dofs_to_inds</cite>.
The default is ‘all’.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>output</strong><span class="classifier">dict</span></dt><dd><p>Dictionary of outputs for specified quantities.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<span class="target" id="module-pywfe.utils.modal_assurance"></span><section id="modal-assurance">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">modal_assurance</a><a class="headerlink" href="#modal-assurance" title="Permalink to this heading">¶</a></h2>
<p>This module contains functions for sorting frequency sweept data by mode index</p>
<dl class="py function">
<dt class="sig sig-object py" id="pywfe.utils.modal_assurance.mac_matrix">
<span class="sig-prename descclassname"><span class="pre">pywfe.utils.modal_assurance.</span></span><span class="sig-name descname"><span class="pre">mac_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">modes_prev</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modes_next</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pywfe.utils.modal_assurance.mac_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Modal Assurance Criterion (MAC) matrix.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pywfe.utils.modal_assurance.sorting_indices">
<span class="sig-prename descclassname"><span class="pre">pywfe.utils.modal_assurance.</span></span><span class="sig-name descname"><span class="pre">sorting_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">modes_prev</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modes_next</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pywfe.utils.modal_assurance.sorting_indices" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pywfe.utils.modal_assurance.sort_wavenumbers">
<span class="sig-prename descclassname"><span class="pre">pywfe.utils.modal_assurance.</span></span><span class="sig-name descname"><span class="pre">sort_wavenumbers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wavenumbers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imag_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pywfe.utils.modal_assurance.sort_wavenumbers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">pywfe</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="model.html">pywfe.Model Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="core.html">core</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">utils</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#io-utils">io_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="#comsol-loader">comsol_loader</a></li>
<li class="toctree-l2"><a class="reference internal" href="#frequency-sweep">frequency_sweep</a></li>
<li class="toctree-l2"><a class="reference internal" href="#modal-assurance">modal_assurance</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples/index.html">Examples</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="core.html" title="previous chapter">core</a></li>
      <li>Next: <a href="examples/index.html" title="next chapter">Examples</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2023, Austen Stone.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 5.0.2</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="_sources/utils.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>